{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport axios from 'axios';\naxios.defaults.baseURL = 'https://pixabay.com';\n\nconst searchForm = document.querySelector('.search-form');\nconst searchQuery = searchForm.querySelector('[name=\"search-query\"]');\nconst loading = document.querySelector('.loader');\nconst nextPage = document.querySelector('.next-page-btn');\nlet hitsCounter = 0;\nlet gallery = document.querySelector('.gallery');\nlet lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst pixabayOptions = {\n  params: {\n    key: '41169627-a3aa19c241ef281e8692ca10a',\n    q: '',\n    image_type: 'photo',\n    orientation: 'horizontal',\n    per_page: 40,\n    safesearch: true,\n    page: 1,\n  },\n};\n\nconst mainObject = {\n  async httpsRequest() {\n    hitsCounter = 0;\n    loading.style.display = 'block';\n    this.removeChilds();\n    try {\n      const posts = await axios.get('/api/?', pixabayOptions);\n      this.totalHitsCheck(posts);\n      console.log(posts.data);\n      this.resultsRunner(posts);\n    } catch (error) {\n      iziToast.show({\n        message: 'Looks like we got some errors =(',\n        messageColor: 'white',\n        backgroundColor: 'rgb(255, 132, 132)',\n        position: 'topRight',\n      });\n      loading.style.display = 'none';\n      console.log(error);\n    }\n  },\n\n  async httpsRequestLoadMore() {\n    loading.style.display = 'block';\n    nextPage.style.display = 'none';\n    try {\n      const posts = await axios.get('/api/?', pixabayOptions);\n      console.log(posts);\n      this.totalHitsCheck(posts);\n      console.log(posts.data);\n      this.resultsRunner(posts);\n    } catch (error) {\n      iziToast.show({\n        message: 'Looks like we got some errors =(',\n        messageColor: 'white',\n        backgroundColor: 'rgb(255, 132, 132)',\n        position: 'topRight',\n      });\n      loading.style.display = 'none';\n      console.log(error);\n    }\n  },\n\n  noResults() {\n    iziToast.show({\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n      messageColor: 'white',\n      backgroundColor: 'rgb(255, 132, 132)',\n      position: 'topRight',\n    });\n  },\n\n  imagesOnPage(posts) {\n    let htmlCode = '';\n    const htmlGen = () => {\n      posts.data.hits.forEach(hit => {\n        htmlCode += `<li class=\"gallery-item\">\n    <a class=\"gallery-link\" href=\"${hit.largeImageURL}\">\n      <img\n        class=\"gallery-image\"\n        src=\"${hit.webformatURL}\"\n        alt=\"${hit.tags}\"\n      />\n    </a>\n    <div class=\"characteristics-container\">\n      <div class=\"photo-characteristics\">\n        <p>Likes</p>\n        <p>${hit.likes}</p>\n      </div>\n      <div class=\"photo-characteristics\">\n        <p>Views</p>\n        <p>${hit.views}</p>\n      </div>\n      <div class=\"photo-characteristics\">\n        <p>Comments</p>\n        <p>${hit.comments}</p>\n      </div>\n      <div class=\"photo-characteristics\">\n        <p>Downloads</p>\n        <p>${hit.downloads}</p>\n      </div>\n    </div>\n  </li>`;\n      });\n    };\n\n    htmlGen();\n    gallery.insertAdjacentHTML('beforeend', htmlCode);\n    lightbox.refresh();\n    htmlCode = '';\n    searchQuery.value = '';\n  },\n\n  removeChilds() {\n    let removeChilds = gallery.querySelectorAll('.gallery-item');\n    removeChilds.forEach(child => {\n      child.remove();\n    });\n  },\n\n  resultsRunner(posts) {\n    if (posts.data.hits.length == 40) {\n      this.imagesOnPage(posts);\n      nextPage.style.display = 'block';\n      loading.style.display = 'none';\n    } else if (posts.data.hits.length < 40 && posts.data.hits.length > 0) {\n      this.imagesOnPage(posts);\n      loading.style.display = 'none';\n      nextPage.style.display = 'none';\n    } else {\n      this.noResults();\n      loading.style.display = 'none';\n    }\n  },\n\n  autoScroll() {\n    let scrollItem = document.querySelector('.gallery-item');\n    let scrollStep = scrollItem.getBoundingClientRect();\n    window.scrollTo({\n      top: window.scrollY + (scrollStep.height * 2 + 48),\n      behavior: 'smooth',\n    });\n  },\n\n  totalHitsCheck(posts) {\n    console.log('im try');\n    hitsCounter += posts.data.hits.length;\n    console.log('im done');\n    console.log(hitsCounter);\n    if (hitsCounter >= posts.data.totalHits && hitsCounter != 0) {\n      nextPage.style.display = 'none';\n      iziToast.show({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        messageColor: 'white',\n        backgroundColor: 'rgb(255, 132, 132)',\n        position: 'topRight',\n      });\n    }\n  },\n};\n\nsearchForm.addEventListener('submit', event => {\n  event.preventDefault();\n  nextPage.style.display = 'none';\n  pixabayOptions.params.page = 1;\n  pixabayOptions.params.q = searchQuery.value.toString();\n  searchForm.after(loading);\n  mainObject.httpsRequest();\n});\n\nnextPage.addEventListener('click', async event => {\n  event.preventDefault();\n  pixabayOptions.params.page += 1;\n  nextPage.after(loading);\n  await mainObject.httpsRequestLoadMore();\n  mainObject.autoScroll();\n});\n"],"names":["axios","searchForm","searchQuery","loading","nextPage","hitsCounter","gallery","lightbox","SimpleLightbox","pixabayOptions","mainObject","posts","error","iziToast","htmlCode","hit","child","scrollStep","event"],"mappings":"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"}